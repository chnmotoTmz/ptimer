# 【Python】日報作成を爆速化！PC操作ログ自動記録＆LLM要約ツール開発【完全解説】

## 📝 はじめに：日報作成、面倒くさくないですか？

「今日1日、何してたっけ…？」
「日報書くのに30分もかかっちゃった…」

エンジニアやデスクワーカーの皆さん、こんな経験ありませんか？
集中して作業していると、自分がどのタスクにどれくらいの時間を使っていたか、意外と覚えていないものです。

そこで今回は、**「PCの操作ログを自動で記録し、LLM（ChatGPTなど）に投げれば一発で日報が完成するツール」**を開発しました！

これで毎日の日報作成タイムが、**「苦痛な記憶喪失タイム」**から**「サクッと1分完了タイム」**に変わります。

---

## 🚀 ツールの概要：何ができるの？

このツールは、バックグラウンドで常駐し、**「現在アクティブなウィンドウ（アプリ名とウィンドウタイトル）」**を自動的に記録し続けます。

### ✨ 主な特徴
1.  **完全自動記録**: 意識せずにバックグラウンドで動作。
2.  **システムトレイ常駐**: 邪魔にならないアイコン表示。一時停止も可能。
3.  **日次CSV出力**: ログは毎日新しいCSVファイルに保存。
4.  **分析＆LLM連携**: 専用スクリプトで集計し、**「日報作成用プロンプト」**を自動生成！

---

## 🛠️ 技術スタックと仕組み

Pythonを使って、WindowsのAPIを叩きながら実装しています。

- **言語**: Python 3.7+
- **ライブラリ**:
    - `psutil`: プロセス情報の取得
    - `pywin32 (win32gui)`: アクティブウィンドウのタイトル取得
    - `pystray`: システムトレイ（通知領域）へのアイコン常駐
    - `pandas`: ログデータの集計・分析

### 📂 構成ファイル
- `pc_activity_logger.py`: 常駐してログを取るメインプログラム
- `analyze_logs.py`: ログを集計し、LLM用プロンプトを作るスクリプト
- `install_startup.bat`: Windows起動時に自動実行するための登録スクリプト

---

## 💻 実際のコードをチラ見せ

### 1. アクティブウィンドウの情報を取る
Windows APIを使って、「今どのウィンドウが一番手前にあるか」を取得します。

```python
def get_active_window_info(self):
    try:
        # アクティブウィンドウのハンドルを取得
        hwnd = win32gui.GetForegroundWindow()
        # プロセスIDを取得
        pid = win32process.GetWindowThreadProcessId(hwnd)[-1]
        # ウィンドウのタイトルバーのテキストを取得
        window_title = win32gui.GetWindowText(hwnd)
        # プロセス名（exe名）を取得
        process_name = psutil.Process(pid).name()
        return pid, window_title, process_name
    except (psutil.NoSuchProcess, Exception):
        return None, "Unknown", "Unknown"
```

### 2. システムトレイに常駐させる
`pystray`を使うと、タスクバーの右下（通知領域）に簡単にアイコンを出せます。ここで「一時停止」や「終了」を制御します。

```python
menu = (
    item('Pause/Resume', on_toggle_pause),
    item('Exit', on_exit)
)
icon = pystray.Icon("pc_activity_logger", image, "PC Activity Logger", menu)
icon.run()
```

### 3. LLMへのプロンプト生成
ここがこのツールの肝です！集計したデータを元に、AIにお願いする文章を自動生成します。

```python
prompt = """あなたは優秀な業務アシスタントです。
以下のPC操作ログから、本日の作業内容を要約してください。
...
【要約フォーマット案】
- **主な活動**: （例: 資料作成、プログラミング、情報収集など）
- **タスクごとの時間配分**:
  - ...
"""
```

---

## 🏃‍♂️ 使ってみよう！導入手順

### 1. 準備
Pythonがインストールされている環境で、必要なライブラリを入れます。

```bash
pip install psutil pywin32 pystray Pillow pandas
```

### 2. 起動
`pythonw.exe`（wがついているのがポイント）で実行すると、黒い画面が出ずにバックグラウンドで動きます。

```bash
pythonw.exe pc_activity_logger.py
```
タスクトレイにアイコンが出ればOK！これであなたのPC操作は記録されています。

### 3. 日報作成（分析）
一日の終わりに、分析スクリプトを実行します。

```bash
python analyze_logs.py
```

すると、以下のような出力が得られます。

```text
[アプリケーション別 合計使用時間]
- Code.exe: 4時間12分
- chrome.exe: 2時間30分
- Slack.exe: 45分

【LLM要約用プロンプト】
（ここにAIへ投げるためのテキストが生成される）
```

あとはこの**【LLM要約用プロンプト】**をコピーして、ChatGPTやClaudeに貼り付けるだけ！
AIがログを読み解き、「今日は○○機能の実装をメインに行い、△△の調査もしました」と綺麗な日報を書いてくれます。

---

## 🎁 スタートアップへの登録
毎回コマンドを打つのは面倒ですよね。
同梱の `install_startup.bat` をダブルクリックするだけで、Windowsの起動時に自動でロガーが立ち上がるようになります。これで記録忘れもありません。

---

## 💡 まとめ：客観的なデータは嘘をつかない

このツールを導入してよかったことは、**「自分の感覚と実際の時間の使い方のズレ」**に気づけたことです。

「今日は一日中コーディングしてた気がする」と思っていても、ログを見ると「実は3割くらいチャットやメール返信に使っていた」なんてことがよくあります。

客観的なログがあれば、日報作成が楽になるだけでなく、**「自分の働き方の改善」**にも繋がります。

ぜひ、この自作ツールで快適なエンジニアライフを送ってみてください！

### 🔗 ダウンロード
ソースコード一式はGitHubで公開しています。（※URLはダミーです）
`https://github.com/your-repo/pc-activity-logger`

**Happy Hacking!** 👨‍💻👩‍💻
